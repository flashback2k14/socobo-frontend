<script rel="script" src="lib/ValidateModule.js"></script>
<script rel="script" src="lib/MessageModule.js"></script>

<script>

  var RecipeBehaviors = RecipeBehaviors || {};
  RecipeBehaviors.ValidateBehavior = {

    validate : function(){
      var errorMsg = new MessageModule();
      var titelExists, textExists, stpsExists, ingrExists;

      titelExists = ValidateModule.verifySingleProperty(this.recipe, "desc");
      textExists = ValidateModule.verifySingleProperty(this.recipe, "text");
      stpsExists = ValidateModule.verifyArrayNotEmpty(this.recipe.steps);
      ingrExists = ValidateModule.verifyArrayNotEmpty(this.recipe.ingredients);

      if(!titelExists){
        errorMsg.addMsgPart("title");
      }
      if(!textExists && !stpsExists){
        errorMsg.addMsgPart("description or steps");
      }
      if(stpsExists){
        var missingSteps = ValidateModule.verifyAll(this.recipe.steps, ["desc"]);
        if(ValidateModule.verifyArrayNotEmpty(missingSteps)){
          errorMsg.addMsgParts("Steps ",missingSteps)
        }
      }
      if(!ingrExists){
        errorMsg.addMsgPart("Ingredients");
      }else{
        var missingIngredients = ValidateModule
          .verifyAll(this.recipe.ingredients, ["desc", "amount", "unit"]);
        if(ValidateModule.verifyArrayNotEmpty(missingIngredients)){
          errorMsg.addMsgParts("Ingredients ", missingIngredients);
        }
      }
      alert(errorMsg.buildMsg());
    }

  }

</script>
